<!DOCTYPE html>
<html>
  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <link href='https://fonts.googleapis.com/css?family=Chivo:900' rel='stylesheet' type='text/css'>
    <link rel="stylesheet" type="text/css" href="stylesheets/stylesheet.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/pygment_trac.css" media="screen">
    <link rel="stylesheet" type="text/css" href="stylesheets/print.css" media="print">
    <!--[if lt IE 9]>
    <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <title>Excel2entity by mylxsw</title>
  </head>

  <body>
    <div id="container">
      <div class="inner">

        <header>
          <h1>Excel2entity</h1>
          <h2>该项目实现批量导入Excel记录时，自动转换行为Java实体对象</h2>
        </header>

        <section id="downloads" class="clearfix">
          <a href="https://github.com/mylxsw/Excel2Entity/zipball/master" id="download-zip" class="button"><span>Download .zip</span></a>
          <a href="https://github.com/mylxsw/Excel2Entity/tarball/master" id="download-tar-gz" class="button"><span>Download .tar.gz</span></a>
          <a href="https://github.com/mylxsw/Excel2Entity" id="view-on-github" class="button"><span>View on GitHub</span></a>
        </section>

        <hr>

        <section id="main_content">
          <h1>
<a name="excel2entity" class="anchor" href="#excel2entity"><span class="octicon octicon-link"></span></a>Excel2Entity</h1>

<div>
                            <p>该类库（Excel2Entity, 简称e2e）对POI对xls文件的读取进行了封装，实现了批量导入Excel中的数据时自动将数据填充到实体列表的功能， 支持字段类型校验以及自定义校验规则，可以对Excel中的数据类型合法性进行校验，同时e2e提供了一定的扩展性，可以自定义校验规则以及自定义实体对象字段类型实现更加负责的校验以及字段类型填充。</p>
<ul>
<li><p><strong>Excel2Entity依赖于Apache POI类库。</strong></p></li>
<li><p><strong>项目基于Maven。</strong></p></li>
<li><p><strong>项目托管在Github。</strong><br></p></li>
</ul>
<pre>https://github.com/mylxsw/Excel2Entity.git</pre>
<p><br></p>
<ul><li><p><strong>使用方法：</strong></p></li></ul>
<p><br></p>
<p>    1. 普通实体创建<br></p>
<p>    </p>
<pre>ExcelHelper eh = ExcelHelper.readExcel("111.xls");
List&lt;Demo&gt; entitys  = null;
try {
    entitys = eh.toEntitys(Demo.class);
    for (Demo d : entitys) {
        System.out.println(d.toString());
    }
} catch (ExcelParseException e) {
    System.out.println(e.getMessage());
} catch (ExcelContentInvalidException e) {
    System.out.println(e.getMessage());
} catch (ExcelRegexpValidFailedException e) {
    System.out.println(e.getMessage());
}</pre>
<p>    2. 注册新的字段类型<br></p>
<p>    注册的新的字段类型类必须实现ExcelType抽象类。</p>
<pre>ExcelHelper.registerNewType(MyDataType.class);</pre>
<p>    3. 实体对象<br></p>
<p>    实体类必须标注@ExcelEntity注解， 同时需要填充的字段标注@ExcelProperty注解<br></p>
<p>    </p>
<pre>@ExcelEntity
public class Demo {
    @ExcelProperty(value="Name", rule=MyStringCheckRule.class)
    private String name;

    @ExcelProperty("Sex")
    private String sex;
        // 基于正则表达式的字段校验
    @ExcelProperty(value="Age", regexp="^[1-4]{1}[0-9]{1}$", regexpErrorMessage="年龄必须在10-49岁之间")
    private int age;

    @ExcelProperty(value="Tel")
    private Long tel;
    
    @ExcelProperty("创建时间")
    private Timestamp createDate;
    
    @ExcelProperty(value="Name", required=true)
    private MyDataType name2;
    

... [get/set方法]
}</pre>
<p>    4. 自定义校验规则<br></p>
<p>    自定义校验规则必须实现ExcelRule接口</p>
<pre>public class MyStringCheckRule implements ExcelRule&lt;String&gt; {
        // 字段检查
    public void check(Object value, String columnName, String fieldName) throws ExcelContentInvalidException {
        String val = (String) value;
        System.out.println("--------&gt;   检测的列名为  " + columnName + "， 填充的字段名为 " + fieldName );
        if(val.length() &gt; 10){
            throw new ExcelContentInvalidException("内容超长!");
        }
    }
        // 结果修改
    public String filter(Object value, String columnName, String fieldName) {
        String val = (String) value;
        return "[[[[" + val + "]]]";
    }

}</pre>
<p><br></p>                        <p> 转载请注明来源:  <a href="http://aicode.cc/article/319.html">http://aicode.cc/article/319.html</a> </p>
        </div>
        </section>

        <footer>
          Excel2entity is maintained by <a href="https://github.com/mylxsw">mylxsw</a><br>
          This page was generated by <a href="http://pages.github.com">GitHub Pages</a>. Tactile theme by <a href="https://twitter.com/jasonlong">Jason Long</a>.
        </footer>

        
      </div>
    </div>
  </body>
</html>